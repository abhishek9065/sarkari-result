import React, { useState, useEffect } from 'react';\nimport './SecurityDashboard.css';\n\nexport interface SecurityMetrics {\n    totalSessions: number;\n    activeSessions: number;\n    suspiciousSessions: number;\n    failedLogins: number;\n    blockedIPs: number;\n    activeIPRules: number;\n    twoFactorUsers: number;\n    passwordPolicyCompliance: number;\n    lastSecurityScan: string;\n    riskLevel: 'low' | 'medium' | 'high' | 'critical';\n    alerts: SecurityAlert[];\n    recentActivity: SecurityActivity[];\n}\n\nexport interface SecurityAlert {\n    id: string;\n    type: 'warning' | 'error' | 'info';\n    title: string;\n    message: string;\n    timestamp: string;\n    severity: 'low' | 'medium' | 'high' | 'critical';\n    actionRequired: boolean;\n    resolved: boolean;\n}\n\nexport interface SecurityActivity {\n    id: string;\n    action: string;\n    user: string;\n    ip: string;\n    timestamp: string;\n    success: boolean;\n    details?: string;\n}\n\ninterface SecurityDashboardProps {\n    metrics: SecurityMetrics;\n    onRefresh: () => Promise<void>;\n    onResolveAlert: (alertId: string) => Promise<void>;\n    onRunSecurityScan: () => Promise<void>;\n    loading?: boolean;\n}\n\nexport function SecurityDashboard({ \n    metrics, \n    onRefresh, \n    onResolveAlert, \n    onRunSecurityScan, \n    loading = false \n}: SecurityDashboardProps) {\n    const [autoRefresh, setAutoRefresh] = useState(true);\n    const [selectedTimeframe, setSelectedTimeframe] = useState<'1h' | '24h' | '7d' | '30d'>('24h');\n    const [showAllAlerts, setShowAllAlerts] = useState(false);\n\n    // Auto refresh every 30 seconds if enabled\n    useEffect(() => {\n        if (!autoRefresh) return;\n        \n        const interval = setInterval(() => {\n            onRefresh();\n        }, 30000);\n        \n        return () => clearInterval(interval);\n    }, [autoRefresh, onRefresh]);\n\n    const getRiskColor = (risk: string) => {\n        switch (risk) {\n            case 'low': return '#22c55e';\n            case 'medium': return '#fbbf24';\n            case 'high': return '#f97316';\n            case 'critical': return '#ef4444';\n            default: return '#64748b';\n        }\n    };\n\n    const getRiskIcon = (risk: string) => {\n        switch (risk) {\n            case 'low': return 'üü¢';\n            case 'medium': return 'üü°';\n            case 'high': return 'üü†';\n            case 'critical': return 'üî¥';\n            default: return 'üîò';\n        }\n    };\n\n    const getAlertIcon = (type: string, severity: string) => {\n        if (severity === 'critical') return 'üö®';\n        if (severity === 'high') return '‚ö†Ô∏è';\n        switch (type) {\n            case 'warning': return '‚ö†Ô∏è';\n            case 'error': return '‚ùå';\n            case 'info': return '‚ÑπÔ∏è';\n            default: return 'üîî';\n        }\n    };\n\n    const formatTimestamp = (timestamp: string) => {\n        const date = new Date(timestamp);\n        const now = new Date();\n        const diffMs = now.getTime() - date.getTime();\n        const diffMins = Math.floor(diffMs / 60000);\n        const diffHours = Math.floor(diffMs / 3600000);\n        \n        if (diffMins < 1) return 'Just now';\n        if (diffMins < 60) return `${diffMins}m ago`;\n        if (diffHours < 24) return `${diffHours}h ago`;\n        return date.toLocaleDateString();\n    };\n\n    const unresolvedAlerts = metrics.alerts.filter(alert => !alert.resolved);\n    const criticalAlerts = unresolvedAlerts.filter(alert => alert.severity === 'critical');\n    const highAlerts = unresolvedAlerts.filter(alert => alert.severity === 'high');\n\n    return (\n        <div className=\"security-dashboard\">\n            <div className=\"security-header\">\n                <div className=\"header-title\">\n                    <h2>üîê Security Center</h2>\n                    <p>Real-time security monitoring and threat detection</p>\n                </div>\n                \n                <div className=\"header-controls\">\n                    <select \n                        value={selectedTimeframe} \n                        onChange={(e) => setSelectedTimeframe(e.target.value as any)}\n                        className=\"timeframe-select\"\n                    >\n                        <option value=\"1h\">Last Hour</option>\n                        <option value=\"24h\">Last 24 Hours</option>\n                        <option value=\"7d\">Last 7 Days</option>\n                        <option value=\"30d\">Last 30 Days</option>\n                    </select>\n                    \n                    <label className=\"auto-refresh-toggle\">\n                        <input\n                            type=\"checkbox\"\n                            checked={autoRefresh}\n                            onChange={(e) => setAutoRefresh(e.target.checked)}\n                        />\n                        <span>Auto-refresh</span>\n                    </label>\n                    \n                    <button \n                        className=\"refresh-btn\"\n                        onClick={onRefresh}\n                        disabled={loading}\n                        title=\"Refresh security metrics\"\n                    >\n                        <span className={`refresh-icon ${loading ? 'spinning' : ''}`}>üîÑ</span>\n                        Refresh\n                    </button>\n                </div>\n            </div>\n\n            {/* Risk Overview */}\n            <div className=\"risk-overview\">\n                <div className=\"risk-main\">\n                    <div className=\"risk-indicator\">\n                        <div \n                            className=\"risk-circle\"\n                            style={{ \n                                background: `conic-gradient(${getRiskColor(metrics.riskLevel)} 0deg, ${getRiskColor(metrics.riskLevel)} 270deg, rgba(100, 116, 139, 0.2) 270deg, rgba(100, 116, 139, 0.2) 360deg)` \n                            }}\n                        >\n                            <div className=\"risk-content\">\n                                <span className=\"risk-icon\">{getRiskIcon(metrics.riskLevel)}</span>\n                                <span className=\"risk-text\">{metrics.riskLevel.toUpperCase()}</span>\n                                <span className=\"risk-label\">Security Risk</span>\n                            </div>\n                        </div>\n                    </div>\n                    \n                    <div className=\"risk-summary\">\n                        <h3>Security Status</h3>\n                        <div className=\"risk-items\">\n                            <div className=\"risk-item\">\n                                <span className=\"risk-item-label\">Last Scan:</span>\n                                <span className=\"risk-item-value\">{formatTimestamp(metrics.lastSecurityScan)}</span>\n                            </div>\n                            <div className=\"risk-item\">\n                                <span className=\"risk-item-label\">Active Alerts:</span>\n                                <span className=\"risk-item-value\">{unresolvedAlerts.length}</span>\n                            </div>\n                            <div className=\"risk-item\">\n                                <span className=\"risk-item-label\">Critical Issues:</span>\n                                <span className=\"risk-item-value critical\">{criticalAlerts.length}</span>\n                            </div>\n                        </div>\n                        \n                        <button \n                            className=\"scan-btn\"\n                            onClick={onRunSecurityScan}\n                            disabled={loading}\n                        >\n                            üîç Run Security Scan\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            {/* Security Metrics Grid */}\n            <div className=\"metrics-grid\">\n                <div className=\"metric-card sessions\">\n                    <div className=\"metric-header\">\n                        <span className=\"metric-icon\">üë•</span>\n                        <h4>Sessions</h4>\n                    </div>\n                    <div className=\"metric-stats\">\n                        <div className=\"metric-main\">\n                            <span className=\"metric-value\">{metrics.activeSessions}</span>\n                            <span className=\"metric-label\">Active</span>\n                        </div>\n                        <div className=\"metric-secondary\">\n                            <div className=\"metric-item\">\n                                <span className=\"value\">{metrics.totalSessions}</span>\n                                <span className=\"label\">Total</span>\n                            </div>\n                            <div className=\"metric-item\">\n                                <span className=\"value suspicious\">{metrics.suspiciousSessions}</span>\n                                <span className=\"label\">Suspicious</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"metric-card authentication\">\n                    <div className=\"metric-header\">\n                        <span className=\"metric-icon\">üîê</span>\n                        <h4>Authentication</h4>\n                    </div>\n                    <div className=\"metric-stats\">\n                        <div className=\"metric-main\">\n                            <span className=\"metric-value\">{metrics.failedLogins}</span>\n                            <span className=\"metric-label\">Failed Logins</span>\n                        </div>\n                        <div className=\"metric-secondary\">\n                            <div className=\"metric-item\">\n                                <span className=\"value\">{metrics.twoFactorUsers}</span>\n                                <span className=\"label\">2FA Users</span>\n                            </div>\n                            <div className=\"metric-item\">\n                                <span className=\"value\">{metrics.passwordPolicyCompliance}%</span>\n                                <span className=\"label\">Policy Compliance</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"metric-card network\">\n                    <div className=\"metric-header\">\n                        <span className=\"metric-icon\">üåê</span>\n                        <h4>Network Security</h4>\n                    </div>\n                    <div className=\"metric-stats\">\n                        <div className=\"metric-main\">\n                            <span className=\"metric-value\">{metrics.blockedIPs}</span>\n                            <span className=\"metric-label\">Blocked IPs</span>\n                        </div>\n                        <div className=\"metric-secondary\">\n                            <div className=\"metric-item\">\n                                <span className=\"value\">{metrics.activeIPRules}</span>\n                                <span className=\"label\">Active Rules</span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Security Alerts */}\n            <div className=\"alerts-section\">\n                <div className=\"alerts-header\">\n                    <h3>üö® Security Alerts ({unresolvedAlerts.length})</h3>\n                    \n                    {unresolvedAlerts.length > 3 && (\n                        <button \n                            className=\"show-all-btn\"\n                            onClick={() => setShowAllAlerts(!showAllAlerts)}\n                        >\n                            {showAllAlerts ? 'Show Less' : `Show All (${unresolvedAlerts.length})`}\n                        </button>\n                    )}\n                </div>\n                \n                {unresolvedAlerts.length === 0 ? (\n                    <div className=\"no-alerts\">\n                        <span className=\"no-alerts-icon\">‚úÖ</span>\n                        <h4>All Clear!</h4>\n                        <p>No active security alerts. Your system is secure.</p>\n                    </div>\n                ) : (\n                    <div className=\"alerts-list\">\n                        {(showAllAlerts ? unresolvedAlerts : unresolvedAlerts.slice(0, 3)).map((alert) => (\n                            <div key={alert.id} className={`alert-card ${alert.severity}`}>\n                                <div className=\"alert-main\">\n                                    <div className=\"alert-icon\">\n                                        {getAlertIcon(alert.type, alert.severity)}\n                                    </div>\n                                    <div className=\"alert-content\">\n                                        <div className=\"alert-title\">{alert.title}</div>\n                                        <div className=\"alert-message\">{alert.message}</div>\n                                        <div className=\"alert-meta\">\n                                            <span className={`severity-badge ${alert.severity}`}>\n                                                {alert.severity.toUpperCase()}\n                                            </span>\n                                            <span className=\"alert-time\">\n                                                {formatTimestamp(alert.timestamp)}\n                                            </span>\n                                            {alert.actionRequired && (\n                                                <span className=\"action-required\">‚ö° Action Required</span>\n                                            )}\n                                        </div>\n                                    </div>\n                                </div>\n                                <div className=\"alert-actions\">\n                                    <button \n                                        className=\"resolve-btn\"\n                                        onClick={() => onResolveAlert(alert.id)}\n                                        disabled={loading}\n                                    >\n                                        ‚úÖ Resolve\n                                    </button>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n\n            {/* Recent Activity */}\n            <div className=\"activity-section\">\n                <h3>üìä Recent Security Activity</h3>\n                \n                {metrics.recentActivity.length === 0 ? (\n                    <div className=\"no-activity\">\n                        <p>No recent security activity to display.</p>\n                    </div>\n                ) : (\n                    <div className=\"activity-list\">\n                        <div className=\"activity-header\">\n                            <div className=\"header-action\">Action</div>\n                            <div className=\"header-user\">User</div>\n                            <div className=\"header-ip\">IP Address</div>\n                            <div className=\"header-time\">Time</div>\n                            <div className=\"header-status\">Status</div>\n                        </div>\n                        {metrics.recentActivity.slice(0, 10).map((activity) => (\n                            <div key={activity.id} className={`activity-row ${activity.success ? 'success' : 'failure'}`}>\n                                <div className=\"activity-action\">{activity.action}</div>\n                                <div className=\"activity-user\">{activity.user}</div>\n                                <div className=\"activity-ip\">\n                                    <span className=\"ip-text\">{activity.ip}</span>\n                                </div>\n                                <div className=\"activity-time\">{formatTimestamp(activity.timestamp)}</div>\n                                <div className=\"activity-status\">\n                                    <span className={`status-badge ${activity.success ? 'success' : 'failure'}`}>\n                                        {activity.success ? '‚úÖ Success' : '‚ùå Failed'}\n                                    </span>\n                                </div>\n                            </div>\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default SecurityDashboard;"