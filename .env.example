# Environment variables for Docker Compose
# Copy this to .env and fill in your values

# JWT Secret (generate with: openssl rand -base64 32)
JWT_SECRET=your-super-secret-jwt-key
JWT_EXPIRY=1d
ADMIN_JWT_EXPIRY=6h
# Optional: enforce issuer/audience on JWTs (recommended for high security)
JWT_ISSUER=sarkariexams-api
JWT_AUDIENCE=sarkariexams-admin

# CORS (comma-separated origins)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000,https://sarkariexams.me,https://www.sarkariexams.me

# Rate limiting (in milliseconds and max requests)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX=200
AUTH_RATE_LIMIT_MAX=20
ADMIN_RATE_LIMIT_MAX=200

# Admin security (optional hardening)
# Comma-separated IPs allowed to access admin endpoints.
ADMIN_IP_ALLOWLIST=
# Comma-separated admin emails allowed to login as admin.
ADMIN_EMAIL_ALLOWLIST=
# Comma-separated admin email domains allowed to login as admin (e.g. company.com).
ADMIN_DOMAIN_ALLOWLIST=
# Require HTTPS for admin endpoints in production.
ADMIN_ENFORCE_HTTPS=true
# Admin setup key (required in production).
ADMIN_SETUP_KEY=change-this-strong-key
# Require 2FA for admin logins (recommended in production).
ADMIN_REQUIRE_2FA=true
# Separate admin auth cookie name.
ADMIN_AUTH_COOKIE_NAME=admin_auth_token
# Admin setup token expiry (used for 2FA enrollment).
ADMIN_SETUP_TOKEN_EXPIRY=15m
# TOTP issuer name and encryption key for stored secrets.
TOTP_ISSUER=SarkariExams Admin
TOTP_ENCRYPTION_KEY=change-this-strong-encryption-key
# Step-up token TTL for sensitive admin actions (in seconds).
ADMIN_STEP_UP_TTL_SECONDS=600
# Session policy hardening.
ADMIN_SESSION_IDLE_TIMEOUT_MINUTES=30
ADMIN_SESSION_ABSOLUTE_TIMEOUT_HOURS=12
# Require dual approval for high-risk publish/delete operations.
ADMIN_DUAL_APPROVAL_REQUIRED=true
# Pending approval expiry window.
ADMIN_APPROVAL_EXPIRY_MINUTES=30
# Retain resolved approval records for this many days before purge.
ADMIN_APPROVAL_RETENTION_DAYS=30
# Frequency of approval lifecycle cleanup jobs (minutes).
ADMIN_APPROVAL_CLEANUP_INTERVAL_MINUTES=60
# Optional policy overrides for approval rules by action type.
# Example: {"announcement_delete":{"enabled":true,"risk":"critical","bypassRoles":["admin"]}}
ADMIN_APPROVAL_POLICY_MATRIX=
# Optional mailbox for additional security alerts.
ADMIN_SECURITY_ALERT_EMAIL=
# Security log retention period (hours).
SECURITY_LOG_RETENTION_HOURS=24
# Persist security logs into database collection.
SECURITY_LOG_PERSISTENCE_ENABLED=true
# Retain persisted security logs for this many days.
SECURITY_LOG_DB_RETENTION_DAYS=30
# Cleanup frequency for persisted security logs (minutes).
SECURITY_LOG_CLEANUP_INTERVAL_MINUTES=60
# Optional: backup code hash salt (defaults to JWT_SECRET if omitted).
ADMIN_BACKUP_CODE_SALT=change-this-backup-salt

# Password hardening
PASSWORD_HISTORY_LIMIT=5
PASSWORD_BREACH_CHECK_ENABLED=true
PASSWORD_BREACH_CHECK_TIMEOUT_MS=2500

# SendGrid (for emails)
SENDGRID_API_KEY=your-sendgrid-api-key

# Redis Cache (Upstash - for performance)
# Get free Redis at: https://upstash.com
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Azure Cosmos DB (MongoDB API) - PRIMARY DATABASE
# Get from Azure Portal: Cosmos DB -> Connection String
COSMOS_CONNECTION_STRING=mongodb://accountname:password@accountname.mongo.cosmos.azure.com:10255/?ssl=true&replicaSet=globaldb&retrywrites=false
COSMOS_DATABASE_NAME=sarkari_db

# Error Tracking (Sentry.io)
SENTRY_DSN=https://your-key@your-org.ingest.sentry.io/project-id
# Frontend Sentry
VITE_SENTRY_DSN=
VITE_SENTRY_RELEASE=
VITE_APP_VERSION=1.0.0

# Infrastructure Monitoring (Datadog)
# Get API key from: https://app.datadoghq.com/organization-settings/api-keys
DD_API_KEY=your-datadog-api-key
# Site options: datadoghq.com (US), datadoghq.eu (EU), us5.datadoghq.com (US5)
DD_SITE=datadoghq.com

# Metrics endpoint protection (optional)
METRICS_TOKEN=

# Web Push (VAPID)
VAPID_PUBLIC_KEY=
VAPID_PRIVATE_KEY=
FRONTEND_URL=https://sarkariexams.me

# Background schedulers (optional tuning)
# Digest sender scheduler
DIGEST_SCHEDULER_INTERVAL_MS=900000
DIGEST_DAILY_HOUR_UTC=7
DIGEST_WEEKLY_DAY_UTC=1
DIGEST_WEEKLY_HOUR_UTC=8
DIGEST_MAX_ITEMS=12

# Tracked/bookmarked deadline reminders scheduler
TRACKER_REMINDER_INTERVAL_MS=1800000
TRACKER_REMINDER_LEAD_DAYS=3
TRACKER_REMINDER_MAX_EMAIL_ITEMS=10

# Saved search alerts scheduler
SAVED_SEARCH_ALERT_INTERVAL_MS=1800000
SAVED_SEARCH_ALERT_MAX_SEARCHES=300
SAVED_SEARCH_ALERT_MAX_EMAIL_ITEMS=12
SAVED_SEARCH_ALERT_DAILY_WINDOW_DAYS=1
SAVED_SEARCH_ALERT_WEEKLY_WINDOW_DAYS=7
SAVED_SEARCH_ALERT_INSTANT_WINDOW_DAYS=1
SAVED_SEARCH_ALERT_INSTANT_COOLDOWN_MINUTES=60
